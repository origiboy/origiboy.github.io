 (function(a){a.fn.styler=function(c){var b=a.extend({wrapper:"form",idSuffix:"-styler",filePlaceholder:"\u0424\u0430\u0439\u043b \u043d\u0435 \u0432\u044b\u0431\u0440\u0430\u043d",fileBrowse:"\u041e\u0431\u0437\u043e\u0440...",selectSearch:!0,selectSearchLimit:10,selectSearchNotFound:"\u0421\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0439 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e",selectSearchPlaceholder:"\u041f\u043e\u0438\u0441\u043a...",selectVisibleOptions:0,singleSelectzIndex:"100",selectSmartPositioning:!0,onSelectOpened:function(){},onSelectClosed:function(){},onFormStyled:function(){}},c);return this.each(function(){function e(){var n="",h="",g="",j="";void 0!==d.attr("id")&&""!==d.attr("id")&&(n=' id="'+d.attr("id")+b.idSuffix+'"');void 0!==d.attr("title")&&""!==d.attr("title")&&(h=' title="'+d.attr("title")+'"');void 0!==d.attr("class")&&""!==d.attr("class")&&(g=" "+d.attr("class"));for(var k=d.data(),l=0;l<k.length;l++){""!==k[l]&&(j+=" data-"+l+'="'+k[l]+'"')}this.id=n+j;this.title=h;this.classes=g}var d=a(this);if(d.is(":checkbox")){d.each(function(){if(1>d.parent("div.jq-checkbox").length){var f=function(){var h=new e,g=a("<div"+h.id+' class="jq-checkbox'+h.classes+'"'+h.title+'><div class="jq-checkbox__div"></div></div>');d.css({position:"absolute",zIndex:"-1",opacity:0,margin:0,padding:0}).after(g).prependTo(g);g.attr("unselectable","on").css({"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","-o-user-select":"none","user-select":"none",display:"inline-block",position:"relative",overflow:"hidden"});d.is(":checked")&&g.addClass("checked");d.is(":disabled")&&g.addClass("disabled");g.on("click.styler",function(){g.is(".disabled")||(d.is(":checked")?(d.prop("checked",!1),g.removeClass("checked")):(d.prop("checked",!0),g.addClass("checked")),d.change());return !1});d.closest("label").add('label[for="'+d.attr("id")+'"]').click(function(j){g.click();j.preventDefault()});d.on("change.styler",function(){d.is(":checked")?g.addClass("checked"):g.removeClass("checked")}).on("keydown.styler",function(j){32==j.which&&g.click()}).on("focus.styler",function(){g.is(".disabled")||g.addClass("focused")}).on("blur.styler",function(){g.removeClass("focused")})};f();d.on("refresh",function(){d.off(".styler").parent().before(d).remove();f()})}})}else{if(d.is(":radio")){d.each(function(){if(1>d.parent("div.jq-radio").length){var f=function(){var h=new e,g=a("<div"+h.id+' class="jq-radio'+h.classes+'"'+h.title+'><div class="jq-radio__div"></div></div>');d.css({position:"absolute",zIndex:"-1",opacity:0,margin:0,padding:0}).after(g).prependTo(g);g.attr("unselectable","on").css({"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","-o-user-select":"none","user-select":"none",display:"inline-block",position:"relative"});d.is(":checked")&&g.addClass("checked");d.is(":disabled")&&g.addClass("disabled");g.on("click.styler",function(){g.is(".disabled")||(g.closest(b.wrapper).find('input[name="'+d.attr("name")+'"]').prop("checked",!1).parent().removeClass("checked"),d.prop("checked",!0).parent().addClass("checked"),d.change());return !1});d.closest("label").add('label[for="'+d.attr("id")+'"]').click(function(j){g.click();j.preventDefault()});d.on("change.styler",function(){d.parent().addClass("checked")}).on("focus.styler",function(){g.is(".disabled")||g.addClass("focused")}).on("blur.styler",function(){g.removeClass("focused")})};f();d.on("refresh",function(){d.off(".styler").parent().before(d).remove();f()})}})}else{if(d.is(":file")){d.css({position:"absolute",top:0,right:0,width:"100%",height:"100%",opacity:0,margin:0,padding:0}).each(function(){if(1>d.parent("div.jq-file").length){var f=function(){var j=new e,h=a("<div"+j.id+' class="jq-file'+j.classes+'"'+j.title+' style="display: inline-block; position: relative; overflow: hidden"></div>'),k=a('<div class="jq-file__name">'+b.filePlaceholder+"</div>").appendTo(h);a('<div class="jq-file__browse">'+b.fileBrowse+"</div>").appendTo(h);d.after(h);h.append(d);d.is(":disabled")&&h.addClass("disabled");d.on("change.styler",function(){var n=d.val();if(d.is("[multiple]")){for(var n="",l=d[0].files,g=0;g<l.length;g++){n+=(0<g?", ":"")+l[g].name}}k.text(n.replace(/.+[\\\/]/,""));""===n?(k.text(b.filePlaceholder),h.removeClass("changed")):h.addClass("changed")}).on("focus.styler",function(){h.addClass("focused")}).on("blur.styler",function(){h.removeClass("focused")}).on("click.styler",function(){h.removeClass("focused")})};f();d.on("refresh",function(){d.off(".styler").parent().before(d).remove();f()})}})}else{if(d.is("select")){d.each(function(){if(1>d.parent("div.jqselect").length){var f=function(){function k(g){g.off("mousewheel DOMMouseScroll").on("mousewheel DOMMouseScroll",function(p){var m=null;"mousewheel"==p.type?m=-1*p.originalEvent.wheelDelta:"DOMMouseScroll"==p.type&&(m=40*p.originalEvent.detail);m&&(p.stopPropagation(),p.preventDefault(),a(this).scrollTop(m+a(this).scrollTop()))})}function j(){i=0;for(len=o.length;i<len;i++){var r="",u="",p=r="",t="",g="";o.eq(i).prop("selected")&&(u="selected sel");o.eq(i).is(":disabled")&&(u="disabled");o.eq(i).is(":selected:disabled")&&(u="selected sel disabled");void 0!==o.eq(i).attr("class")&&(p=" "+o.eq(i).attr("class"),g=' data-jqfs-class="'+o.eq(i).attr("class")+'"');var s=o.eq(i).data(),q;for(q in s){""!==s[q]&&(r+=" data-"+q+'="'+s[q]+'"')}r="<li"+g+r+' class="'+u+p+'">'+o.eq(i).text()+"</li>";o.eq(i).parent().is("optgroup")&&(void 0!==o.eq(i).parent().attr("class")&&(t=" "+o.eq(i).parent().attr("class")),r="<li"+g+' class="'+u+p+" option"+t+'">'+o.eq(i).text()+"</li>",o.eq(i).is(":first-child")&&(r='<li class="optgroup'+t+'">'+o.eq(i).parent().attr("label")+"</li>"+r));h+=r}}function n(){var P=new e,J=a("<div"+P.id+' class="jq-selectbox jqselect'+P.classes+'" style="display: inline-block; position: relative; z-index:'+b.singleSelectzIndex+'"><div class="jq-selectbox__select"'+P.title+' style="position: relative"><div class="jq-selectbox__select-text"></div><div class="jq-selectbox__trigger"><div class="jq-selectbox__trigger-arrow"></div></div></div></div>');d.css({margin:0,padding:0}).after(J).prependTo(J);var P=a("div.jq-selectbox__select",J),w=a("div.jq-selectbox__select-text",J),F=o.filter(":selected");F.length?w.html(F.text()):w.html(o.first().text());j();var D="";b.selectSearch&&(D='<div class="jq-selectbox__search"><input type="search" autocomplete="off" placeholder="'+b.selectSearchPlaceholder+'"></div><div class="jq-selectbox__not-found">'+b.selectSearchNotFound+"</div>");var I=a('<div class="jq-selectbox__dropdown" style="position: absolute">'+D+'<ul style="position: relative; list-style: none; overflow: auto; overflow-x: hidden">'+h+"</ul></div>");J.append(I);var G=a("ul",I),H=a("li",I),g=a("input",I),L=a("div.jq-selectbox__not-found",I).hide();H.length<b.selectSearchLimit&&g.parent().hide();var M=0,x=0;H.each(function(){var p=a(this);p.css({display:"inline-block","white-space":"nowrap"});p.innerWidth()>M&&(M=p.innerWidth(),x=p.width());p.css({display:"block"})});var D=J.clone().appendTo("body").width("auto"),O=D.width();D.remove();O==J.width()&&(w.width(x),M+=J.find("div.jq-selectbox__trigger").width());M>J.width()&&I.width(M);d.css({position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:0});var N=J.outerHeight(),E=g.outerHeight(),K=G.css("max-height"),D=H.filter(".selected");1>D.length&&H.first().addClass("selected sel");void 0===H.data("li-height")&&H.data("li-height",H.outerHeight());var m=I.css("top");"auto"==I.css("left")&&I.css({left:0});"auto"==I.css("top")&&I.css({top:N});I.hide();D.length&&(o.first().text()!=F.text()&&J.addClass("changed"),J.data("jqfs-class",D.data("jqfs-class")),J.addClass(D.data("jqfs-class")));if(d.is(":disabled")){return J.addClass("disabled"),!1}P.click(function(){d.focus();a("div.jq-selectbox").filter(".opened").length&&b.onSelectClosed.call(a("div.jq-selectbox").filter(".opened"));if(!navigator.userAgent.match(/(iPad|iPhone|iPod)/g)){var r=H.data("li-height");if(b.selectSmartPositioning){var y=a(window),v=J.offset().top,A=y.height()-N-(v-y.scrollTop()),u=b.selectVisibleOptions,t=5*r,z=r*u;0<u&&6>u&&(t=z);0===u&&(z="auto");A>t+E+20?(I.height("auto").css({bottom:"auto",top:m}),u=function(){G.css("max-height",Math.floor((A-20-E)/r)*r)},u(),G.css("max-height",z),"none"!=K&&G.css("max-height",K),A<I.outerHeight()+20&&u()):(I.height("auto").css({top:"auto",bottom:m}),u=function(){G.css("max-height",Math.floor((v-y.scrollTop()-20-E)/r)*r)},u(),G.css("max-height",z),"none"!=K&&G.css("max-height",K),v-y.scrollTop()-20<I.outerHeight()+20&&u())}a("div.jqselect").css({zIndex:b.singleSelectzIndex-1}).removeClass("opened");J.css({zIndex:b.singleSelectzIndex});I.is(":hidden")?(a("div.jq-selectbox__dropdown:visible").hide(),I.show(),J.addClass("opened focused"),b.onSelectOpened.call(J)):(I.hide(),J.removeClass("opened"),a("div.jq-selectbox").filter(".opened").length&&b.onSelectClosed.call(J));H.filter(".selected").length&&(0!==G.innerHeight()/r%2&&(r/=2),G.scrollTop(G.scrollTop()+H.filter(".selected").position().top-G.innerHeight()/2+r));g.length&&(g.val("").keyup(),L.hide(),g.keyup(function(){var p=a(this).val();H.each(function(){a(this).html().match(RegExp(".*?"+p+".*?","i"))?a(this).show():a(this).hide()});1>H.filter(":visible").length?L.show():L.hide()}));k(G);return !1}});H.hover(function(){a(this).siblings().removeClass("selected")});H.filter(".selected").text();H.filter(".selected").text();H.filter(":not(.disabled):not(.optgroup)").click(function(){d.focus();var p=a(this),q=p.text();if(!p.is(".selected")){var r=p.index(),r=r-p.prevAll(".optgroup").length;p.addClass("selected sel").siblings().removeClass("selected sel");o.prop("selected",!1).eq(r).prop("selected",!0);w.html(q);J.data("jqfs-class")&&J.removeClass(J.data("jqfs-class"));J.data("jqfs-class",p.data("jqfs-class"));J.addClass(p.data("jqfs-class"));d.change()}g.length&&(g.val("").keyup(),L.hide());I.hide();J.removeClass("opened");b.onSelectClosed.call(J)});I.mouseout(function(){a("li.sel",I).addClass("selected")});d.on("change.styler",function(){w.html(o.filter(":selected").text());H.removeClass("selected sel").not(".optgroup").eq(d[0].selectedIndex).addClass("selected sel");o.first().text()!=H.filter(".selected").text()?J.addClass("changed"):J.removeClass("changed")}).on("focus.styler",function(){J.addClass("focused");a("div.jqselect").removeClass("opened")}).on("blur.styler",function(){J.removeClass("focused")}).on("keydown.styler keyup.styler",function(p){var q=H.data("li-height");w.html(o.filter(":selected").text());H.removeClass("selected sel").not(".optgroup").eq(d[0].selectedIndex).addClass("selected sel");38!=p.which&&37!=p.which&&33!=p.which&&36!=p.which||G.scrollTop(G.scrollTop()+H.filter(".selected").position().top);40!=p.which&&39!=p.which&&34!=p.which&&35!=p.which||G.scrollTop(G.scrollTop()+H.filter(".selected").position().top-G.innerHeight()+q);32==p.which&&p.preventDefault();13==p.which&&(p.preventDefault(),I.hide())});a(document).on("click",function(p){a(p.target).parents().hasClass("jq-selectbox")||"OPTION"==p.target.nodeName||(a("div.jq-selectbox").filter(".opened").length&&b.onSelectClosed.call(a("div.jq-selectbox").filter(".opened")),g.length&&g.val("").keyup(),I.hide().find("li.sel").addClass("selected"),J.removeClass("focused opened"))})}function l(){var s=new e,t=a("<div"+s.id+' class="jq-select-multiple jqselect'+s.classes+'"'+s.title+' style="display: inline-block; position: relative"></div>');d.css({margin:0,padding:0}).after(t);j();t.append("<ul>"+h+"</ul>");var q=a("ul",t).css({position:"relative","overflow-x":"hidden","-webkit-overflow-scrolling":"touch"}),u=a("li",t).attr("unselectable","on").css({"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","-o-user-select":"none","user-select":"none","white-space":"nowrap"}),s=d.attr("size"),r=q.outerHeight(),m=u.outerHeight();void 0!==s&&0<s?q.css({height:m*s}):q.css({height:4*m});r>t.height()&&(q.css("overflowY","scroll"),k(q),u.filter(".selected").length&&q.scrollTop(q.scrollTop()+u.filter(".selected").position().top));d.prependTo(t).css({position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:0});if(d.is(":disabled")){t.addClass("disabled"),o.each(function(){a(this).is(":selected")&&u.eq(a(this).index()).addClass("selected")})}else{if(u.filter(":not(.disabled):not(.optgroup)").click(function(p){d.trigger("focus.styler");var x=a(this);p.ctrlKey||p.metaKey||x.addClass("selected");p.shiftKey||x.addClass("first");p.ctrlKey||(p.metaKey||p.shiftKey)||x.siblings().removeClass("selected first");if(p.ctrlKey||p.metaKey){x.is(".selected")?x.removeClass("selected first"):x.addClass("selected first"),x.siblings().removeClass("first")}if(p.shiftKey){var w=!1,v=!1;x.siblings().removeClass("selected").siblings(".first").addClass("selected");x.prevAll().each(function(){a(this).is(".first")&&(w=!0)});x.nextAll().each(function(){a(this).is(".first")&&(v=!0)});w&&x.prevAll().each(function(){if(a(this).is(".selected")){return !1}a(this).not(".disabled, .optgroup").addClass("selected")});v&&x.nextAll().each(function(){if(a(this).is(".selected")){return !1}a(this).not(".disabled, .optgroup").addClass("selected")});1==u.filter(".selected").length&&x.addClass("first")}o.prop("selected",!1);u.filter(".selected").each(function(){var y=a(this),g=y.index();y.is(".option")&&(g-=y.prevAll(".optgroup").length);o.eq(g).prop("selected",!0)});d.trigger("change.styler")}),o.each(function(g){a(this).data("optionIndex",g)}),d.on("change.styler",function(){u.removeClass("selected");var g=[];o.filter(":selected").each(function(){g.push(a(this).data("optionIndex"))});u.not(".optgroup").filter(function(p){return -1<a.inArray(p,g)}).addClass("selected")}).on("focus.styler",function(){t.addClass("focused")}).on("blur.styler",function(){t.removeClass("focused")}),r>t.height()){d.on("keydown.styler",function(g){38!=g.which&&37!=g.which&&33!=g.which||q.scrollTop(q.scrollTop()+u.filter(".selected").position().top-m);40!=g.which&&39!=g.which&&34!=g.which||q.scrollTop(q.scrollTop()+u.filter(".selected:last").position().top-q.innerHeight()+2*m)})}}}var o=a("option",d),h="";d.is("[multiple]")?l():n()};f();d.on("refresh",function(){d.off(".styler").parent().before(d).remove();f()})}})}else{if(d.is(":reset")){d.on("click",function(){setTimeout(function(){d.closest(b.wrapper).find("input, select").trigger("refresh")},1)})}}}}}}).promise().done(function(){b.onFormStyled.call()})}})(jQuery);